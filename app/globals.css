/* app/globals.css
   NÓMADA FANTASMA — GLOBAL STYLES (Cartografía ↔ Sonar)
   v7.2
*/
@tailwind base;
@tailwind components;
@tailwind utilities;

/* =========================
   VARIABLES / PALETA
   ========================= */
:root {
  --radius: 16px;

  /* LIGHT */
  --background: 216 20% 82%;
  --foreground: 222 50% 16%;

  --primary: 193 88% 44%;
  --primary-foreground: 222 60% 8%;
  --accent: 268 80% 60%;

  --card: 216 18% 90%;
  --card-foreground: 222 50% 16%;
  --border: 216 22% 62%;
  --muted: 214 16% 92%;
  --muted-foreground: 222 12% 34%;

  /* CARTOGRAFÍA (LIGHT) */
  --carto-grid-h: 216 30% 20%;
  --carto-grid-alpha: .40;
  --carto-contour-aqua: .26;
  --carto-contour-accent: .18;
  --carto-overlay: .78;
  --carto-vignette: .06;
  --carto-noise: .016;

  /* Ondas más sutiles (light) */
  --nf-wave-stroke-1: rgba(56,189,248,0.65);
  --nf-wave-stroke-2: rgba(168,85,247,0.55);
  --nf-wave-glow-1:   rgba(56,189,248,0.35);
  --nf-wave-glow-2:   rgba(168,85,247,0.22);

  /* Halo (light) */
  --halo-p: .12;
  --halo-a: .04;

  /* Glass */
  --glass-bg:        255 255 255 / 0.68;
  --glass-border:    15 23 42 / 0.12;
  --glass-shadow:    0 10px 28px -12px rgba(2,6,23,.24);
}

/* DARK */
.dark {
  --background: 220 50% 8%;
  --foreground: 210 40% 97%;

  --primary: 189 100% 58%;
  --primary-foreground: 220 60% 8%;
  --accent: 295 92% 70%;

  --card: 224 40% 12%;
  --card-foreground: 210 40% 97%;
  --border: 220 26% 20%;
  --muted: 224 34% 12%;
  --muted-foreground: 215 18% 74%;

  /* SONAR + ondas (dark) */
  --nf-wave-stroke-1: rgba(125,211,252,0.70);
  --nf-wave-stroke-2: rgba(216,180,254,0.60);
  --nf-wave-glow-1:   rgba(56,189,248,0.40);
  --nf-wave-glow-2:   rgba(168,85,247,0.26);
  --sonar-grid:       0 0% 100%;
  --sonar-grid-alpha: .28;
  --sonar-sweep:      189 100% 58%;

  /* Halo (dark) */
  --halo-p: .28;
  --halo-a: .12;

  --glass-bg:        3 6 18 / 0.52;
  --glass-border:    255 255 255 / 0.14;
  --glass-shadow:    0 16px 34px -16px rgba(0,0,0,.65);

  /* CARTOGRAFÍA (DARK) — tokens nativos */
  --carto-dark-grid-h: 215 18% 78%;
  --carto-dark-grid-alpha: .26;
  --carto-dark-contour-aqua: .20;
  --carto-dark-contour-accent: .14;
  --carto-dark-overlay: .38;
  --carto-dark-vignette: .00;

  /* Alias → cualquier uso de --carto-* queda legible en dark */
  --carto-grid-h: var(--carto-dark-grid-h);
  --carto-grid-alpha: var(--carto-dark-grid-alpha);
  --carto-contour-aqua: var(--carto-dark-contour-aqua);
  --carto-contour-accent: var(--carto-dark-contour-accent);
  --carto-overlay: var(--carto-dark-overlay);
  --carto-vignette: var(--carto-dark-vignette);
}

/* =========================
   BASE
   ========================= */
@layer base {
  *, *::before, *::after { @apply border-border; }

  html { color-scheme: light dark; -webkit-tap-highlight-color: transparent; text-rendering: optimizeLegibility; }

  body {
    @apply bg-background text-foreground antialiased;
    background-image: linear-gradient(180deg, hsl(var(--background)), hsl(var(--background)));
    background-attachment: fixed;
    min-height: 100dvh;
  }

  body.has-ink {
    background-image:
      radial-gradient(60% 40% at 22% 4%, hsl(var(--primary) / 0.12), transparent 56%),
      radial-gradient(40% 30% at 80% 0%, hsl(var(--accent) / 0.08), transparent 72%),
      linear-gradient(180deg, hsl(var(--background)), hsl(var(--background)));
  }
  html.dark body.has-ink {
    background-image:
      radial-gradient(120% 90% at 50% -12%, hsl(var(--primary) / 0.10), transparent 62%),
      radial-gradient(140% 80% at 100% -20%, hsl(var(--accent) / 0.06), transparent 70%),
      linear-gradient(180deg, hsl(var(--background)), hsl(var(--background)));
  }

  h1 { @apply text-4xl sm:text-5xl md:text-6xl font-semibold tracking-tight; }
  h2 { @apply text-2xl sm:text-3xl font-semibold tracking-tight; }
  h3 { @apply text-xl sm:text-2xl font-medium; }

  a { @apply transition-opacity hover:opacity-90; }
  ::selection { background: hsl(var(--primary) / 0.28); color: hsl(var(--foreground)); }

  *::-webkit-scrollbar { width: 10px; height: 10px; }
  *::-webkit-scrollbar-thumb { background: hsl(215 16% 35% / 0.6); border-radius: 9999px; border: 2px solid transparent; background-clip: padding-box; }
  *::-webkit-scrollbar-track { background: transparent; }

  :focus-visible { outline: none; box-shadow: 0 0 0 3px hsl(var(--primary) / 0.38); border-radius: 10px; }
}

@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; scroll-behavior: auto !important; }
}

/* =========================
   COMPONENTS
   ========================= */
@layer components {
  .card-glass {
    background-color: hsl(var(--card) / 0.60);
    -webkit-backdrop-filter: blur(9px); backdrop-filter: blur(9px);
    border: 1px solid hsl(var(--border));
    border-radius: 1.25rem;
    box-shadow: 0 1px 0 0 hsl(0 0% 100% / 0.05) inset, var(--glass-shadow);
  }

  .pill { @apply rounded-2xl border bg-card/40 px-3 py-1 text-sm; }
  .btn  { @apply inline-flex items-center gap-2 rounded-2xl px-4 py-2 text-sm font-medium border select-none transition-all; }

  .btn-primary {
    @apply btn text-[hsl(var(--primary-foreground))] border-0;
    background-image: linear-gradient(180deg, hsl(var(--primary)), hsl(187 92% 44%));
    box-shadow: 0 0 0 1px hsl(var(--primary) / 0.35), 0 10px 32px hsl(var(--primary) / 0.25);
  }

  .btn-ghost {
    @apply btn bg-card/55 text-foreground border-border;
    box-shadow: 0 1px 0 0 hsl(0 0% 100% / 0.05) inset, 0 8px 22px hsl(222 47% 8% / 0.25);
  }

  .btn-cta {
    @apply inline-flex items-center justify-center gap-2 rounded-3xl px-5 py-3 text-base font-medium border-0;
    background-image: linear-gradient(180deg, hsl(var(--primary)), hsl(187 92% 44%));
    color: hsl(var(--primary-foreground));
    box-shadow: 0 0 0 1px hsl(var(--primary) / 0.35), 0 12px 38px hsl(var(--primary) / 0.28);
  }
  .btn-cta:active { transform: translateY(1px); }
}

/* =========================
   UTILITIES
   ========================= */
@layer utilities {
  .text-balance { text-wrap: balance; }
  .text-pretty  { text-wrap: pretty;  }
  .visually-hidden {
    position: absolute !important; height:1px; width:1px;
    overflow:hidden; clip: rect(1px,1px,1px,1px);
    white-space:nowrap; border:0; padding:0; margin:-1px;
  }

  .hero-halo {
    background:
      radial-gradient(120% 120% at 12% -5%, hsl(var(--primary) / var(--halo-p)), transparent 46%),
      radial-gradient(80% 60% at 88% -10%, hsl(var(--accent) / var(--halo-a)), transparent 58%),
      linear-gradient(180deg, hsl(var(--background)), hsl(var(--background)));
  }

  .text-neon-gradient {
    background: linear-gradient(90deg, hsl(var(--primary)), hsl(var(--accent)));
    -webkit-background-clip: text; background-clip: text; color: transparent;
  }

  .glow-aqua { box-shadow: 0 0 0 1px hsl(var(--primary) / 0.38), 0 12px 38px hsl(var(--primary) / 0.28); }

  /* ====== CARTOGRAFÍA ====== */
  .map-surface { position: relative; z-index: 0; overflow: hidden; border-radius: var(--radius); }
  .map-surface::before {
    content:""; position:absolute; inset:-1px; pointer-events:none; z-index:0; border-radius: inherit;
    background-image:
      linear-gradient(to bottom, hsl(var(--carto-grid-h) / var(--carto-grid-alpha)) 1px, transparent 1px),
      linear-gradient(to right,  hsl(var(--carto-grid-h) / var(--carto-grid-alpha)) 1px, transparent 1px),
      repeating-radial-gradient(circle at 18% 28%, transparent 0 14px, hsl(var(--primary) / var(--carto-contour-aqua)) 14px 16px),
      repeating-radial-gradient(circle at 82% 12%, transparent 0 20px, hsl(var(--accent) / var(--carto-contour-accent)) 20px 22px);
    background-size: 28px 28px, 28px 28px, 220px 220px, 320px 320px;
    background-position: center center, center center, 10% 0%, 85% 0%;
    background-repeat: repeat, repeat, no-repeat, no-repeat;
    -webkit-mask-image: radial-gradient(160% 120% at 50% -10%, black 55%, transparent 85%);
            mask-image: radial-gradient(160% 120% at 50% -10%, black 55%, transparent 85%);
    opacity: var(--carto-overlay);
    mix-blend-mode: multiply;
  }
  .map-surface::after {
    content:""; position:absolute; inset:0; pointer-events:none; z-index:1; border-radius: inherit;
    background:
      repeating-linear-gradient(0deg,  hsl(0 0% 100% / var(--carto-noise)) 0 2px, transparent 2px 4px),
      repeating-linear-gradient(90deg, hsl(0 0% 100% / var(--carto-noise)) 0 2px, transparent 2px 4px),
      radial-gradient(140% 80% at 50% 0%, transparent 55%, hsl(0 0% 0% / var(--carto-vignette)) 100%);
    mix-blend-mode: multiply;
  }

  /* ====== SONAR HUD ====== */
  .sonar-hud { position: relative; z-index: 0; overflow: hidden; border-radius: var(--radius); }
  .sonar-hud::before {
    content:""; position:absolute; inset:0; pointer-events:none; z-index:0;
    background-image:
      linear-gradient(to right, hsl(var(--sonar-grid) / var(--sonar-grid-alpha)) 1px, transparent 1px),
      linear-gradient(to bottom, hsl(var(--sonar-grid) / var(--sonar-grid-alpha)) 1px, transparent 1px),
      radial-gradient(circle at 46% 40%, hsl(var(--sonar-grid) / .12) 2px, transparent 3px);
    background-size: 48px 48px, 48px 48px, 14px 14px;
    background-position: center, center, center;
    mix-blend-mode: screen;
  }
  .sonar-hud::after {
    content:""; position:absolute; inset:-20%; pointer-events:none; z-index:1;
    background: conic-gradient(from -30deg at 46% 40%, hsl(var(--sonar-sweep) / .16), transparent 35%);
    filter: blur(10px); mix-blend-mode: screen;
  }

  /* ====== HERO helpers ====== */
  .nf-grid {
    position: absolute; inset: 0;
    background-image:
      linear-gradient(to right, hsl(var(--carto-grid-h) / 0.30) 1px, transparent 1px),
      linear-gradient(to bottom, hsl(var(--carto-grid-h) / 0.30) 1px, transparent 1px);
    background-size: 48px 48px, 48px 48px;
    opacity: .26;
  }
  html.dark .nf-grid { opacity: .32; }
  @media (max-width:1024px){ .nf-grid{ background-size:40px 40px, 40px 40px; } }
  @media (max-width:640px){ .nf-grid{ background-size:32px 32px, 32px 32px; } }

  .nf-vignette {
    background: radial-gradient(80% 60% at 50% 40%, rgba(0,0,0,0) 0%, rgba(0,0,0,.07) 100%);
    mix-blend-mode: normal;
  }

  /* ====== DETALLE: Rosa náutica ====== */
  .compass-rose{
    position:absolute;
    width: clamp(120px, 18vw, 180px);
    aspect-ratio:1;
    pointer-events:none;
    opacity:.22;
    background:
      radial-gradient(closest-side, transparent calc(100% - 2px), hsl(var(--carto-grid-h) / .48) calc(100% - 1px), transparent),
      conic-gradient(from 0deg,
        hsl(var(--primary) / .35) 0 .8deg, transparent .8deg 90deg,
        hsl(var(--primary) / .35) 90deg 90.8deg, transparent 90.8deg 180deg,
        hsl(var(--primary) / .35) 180deg 180.8deg, transparent 180.8deg 270deg,
        hsl(var(--primary) / .35) 270deg 270.8deg, transparent 270.8deg 360deg),
      repeating-conic-gradient(from -90deg, hsl(var(--accent) / .16) 0 1.6deg, transparent 1.6deg 10deg),
      radial-gradient(circle, hsl(var(--primary) / .06) 0 70%, transparent 72% 100%);
    mix-blend-mode:multiply;
    -webkit-mask-image: radial-gradient(closest-side, black 70%, transparent 100%);
            mask-image: radial-gradient(closest-side, black 70%, transparent 100%);
    filter: drop-shadow(0 0 4px hsl(var(--primary) / .10));
  }
  html.dark .compass-rose{
    opacity:.20;
    mix-blend-mode:screen;
    filter: drop-shadow(0 0 8px hsl(var(--primary) / .14));
  }
  .rose-tr{ top:.75rem; right:.75rem; }
  .rose-bl{ bottom:.75rem; left:.75rem; }
  .compass-rose::after{
    content:"N";
    position:absolute; left:50%; top:3px; transform:translateX(-50%);
    font-size:.65rem; font-weight:600; letter-spacing:.06em;
    color:hsl(var(--carto-grid-h) / .55);
  }
  html.dark .compass-rose::after{ color: hsl(0 0% 100% / .55); }
}
